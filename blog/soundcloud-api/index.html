<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhml"
      xmlns:fb="http://ogp.me/ns/fb#"
      xml:lang="en" lang="en">

  <head>
    <title>ngokevin | Scrape the Internet! Our Python Soundcloud API</title>
    <link rel="stylesheet" type="text/css" href="/css/bundle.css" />
    <link href='http://fonts.googleapis.com/css?family=Ubuntu:400,500,700' rel='stylesheet' type='text/css'>
    <link rel="icon" type="image/x-icon" href="/img/favicon.ico?v=5"/>
    <meta name="viewport" content="width=device-width">
    
  <link rel="stylesheet" type="text/css" href="/css/page.css" />
  
    <meta property="og:image" content="http://i.imgur.com/LZ35KEe.gif"/>
  
  <meta property="og:description" content="It was a cold November evening in the bullpen at Oregon State University. uberj and ngoke were sipping tea and getting work done, when the idea of an impromptu hackthon came into our minds. At the strike of 5, we powered ourselves up into coding mode and set off to hack away at a Python Soundcloud API that would allow us to download music from the streams. Thus birthed soundcloud-dl. We first attempted to use Mechanize to scrape the pages. uberj had previously used Burp to monitor what requests the browser was sending to Soundcloud and found that it was passing a &#34;stream token&#34;, which was needed to request the stream, and the song&#39;s &#34;uid&#34;. And we figured we needed to have a valid cookie as well. Security by obsurity much? We ran into a slight hitch. We were able to compose a valid URL with the stream token and the uid, but we weren&#39;t able to print out the cookies. We had to enlist the help of thedjpetersen, the master screenscraper. It took him a bit to independently catch up to where we were (he found out on his own that we needed a stream token, but we already grabbed that). After a bit of frustration on trying to check out what cookies we had with every CookieJar known to man, thedjpetersen proclaimed that he had successfully gotten the URL. We rushed to pull his commit and tried it on a Mord Fustang song...we had the script write the stream to a file, and we opened it in VLC...The song had a length! Except it wasn&#39;t playing. We tried to play it on uberj&#39;s machine...and it worked!. After a high-five session and a burst of gratitude to thedjpetersen, we went to look what he did. He found we had to request a page from a cross-domain, probably for cookies, and then scrape the stream. We went off to wrap everything into a neat package and add more functionality. and thus soundcloud-dl was born"/>

  </head>

  <body>
    <div id="wrap" class="c">
      <header>
        <div class="logos">
          <h1 id="logo">
            <a href='/'>ngo<strong>kevin</strong></a>
            <span class="social">
              <a href="mailto:me@ngokevin.com"><i class="fa fa-envelope"></i></a>
              <a href="http://twitter.com/andgokevin"><i class="fa fa-twitter-square"></i></a>
              <a href="http://github.com/ngokevin"><i class="fa fa-github-square"></i></a>
              <a type="application/rss+xml" href="/rss"><i class="fa fa-rss-square"></i></a>
            </span>
          </h1>
          <span id="sublogo">virtual reality developer at mozilla</span>
          <ul class="blog-tags">
            
              <li>
                <a href="/blog/tags/code/"
                   >
                  Code</a>
              </li>
            
              <li>
                <a href="/blog/tags/life/"
                   >
                  Life</a>
              </li>
            
              <li>
                <a href="/blog/tags/photography/"
                   >
                  Shoot</a>
              </li>
            
              <li>
                <a href="/blog/tags/poker/"
                   >
                  Poker</a>
              </li>
            
          </ul>
        </div>

        <nav>
          
            <a href="/about/">
              <span>
                About</span>
            </a>
          
            <a href="/">
              <span>
                Write</span>
            </a>
          
            <a href="/photography/">
              <span>
                Shoot</span>
            </a>
          
        </nav>
      </header>

      <div class="main">
        <div class="header-group">
  <div class="blog">
    <h1>Scrape the Internet! Our Python Soundcloud API</h1>

    <p class="metadata">
      
        Sunday November 06, 2011
      
    </p>
  </div>

  <div id="top-share" class="addthis_toolbox addthis_default_style">
  <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
  <a class="addthis_button_tweet"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-513af3cd5e69b4ae"></script>
</div>

        <div class="base-image">
          
            <div class="page_pic right">
              <img src="http://i.imgur.com/LZ35KEe.gif">
              
            </div>
          
        </div>

        
  <div class="page c">
    <p>It was a cold November evening in the bullpen at Oregon State University.
<a href="http://uberj.com">uberj</a> and ngoke were sipping tea and getting work done,
when the idea of an impromptu <strong>hackthon</strong> came into our minds. At the strike
of 5, we powered ourselves up into coding mode and set off to hack away at a
<strong>Python Soundcloud API</strong> that would allow us to download music from the
streams. Thus birthed <a href="http://github.com/ngokevin/soundcloud-dl">soundcloud-dl</a>.</p>
<p>We first attempted to use <a href="wwwsearch.sourceforge.net/mechanize/">Mechanize</a> to scrape the pages. uberj had
previously used <a href="http://portswigger.net/proxy">Burp</a> to monitor what requests
the browser was sending to Soundcloud and found that it was passing a "stream
token", which was needed to request the stream, and the song's "uid". And we
figured we needed to have a valid cookie as well. Security by obsurity much?</p>
<p>We ran into a slight hitch. We were able to compose a valid URL with the stream
token and the uid, but we weren't able to print out the cookies. We had to
enlist the help of <a href="http://github.com/thedjpetersen">thedjpetersen</a>, the master
screenscraper. It took him a bit to independently catch up to where we were (he
found out on his own that we needed a stream token, but we already grabbed
that).  After a bit of frustration on trying to check out what cookies we had
with every CookieJar known to man, thedjpetersen proclaimed that he had
successfully gotten the URL.</p>
<p>We rushed to pull his commit and tried it on a Mord Fustang song...we had the script write the stream to a file, and we opened it in VLC...The song had a length! Except it wasn't
playing. We tried to play it on uberj's machine...<strong>and it worked!</strong>. After a high-five
session and a burst of gratitude to thedjpetersen, we went to look what he did. He
found we had to request a page from a cross-domain, probably for cookies, and then
scrape the stream. We went off to wrap everything into a neat package and add
more functionality.</p>
<p><strong>and thus soundcloud-dl was born</strong></p>
  </div>

  <p class="end-sect">&sect;</p>
  <div id="bottom-share" class="addthis_toolbox addthis_default_style">
  <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
  <a class="addthis_button_tweet"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-513af3cd5e69b4ae"></script>
   <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'ngokevin'; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
           var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
           dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
           (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
  <script src="https://cdn.jsdelivr.net/anchorjs/3.0.0/anchor.min.js"></script>
  <script>anchors.add('h2, h3, h4, h5, h6');</script>

      </div>
    </div>

    <div id="footer">
      <a href="mailto:me@ngokevin.com"><i class="fa fa-envelope"></i></a>
      <a href="http://twitter.com/ngokevin_"><i class="fa fa-twitter-square"></i></a>
      <a href="http://github.com/ngokevin"><i class="fa fa-github-square"></i></a>
      <a type="application/rss+xml" href="/rss/index.xml"><i class="fa fa-rss-square"></i></a>
    </div>

     <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-29871909-1']);
  _gaq.push(['_trackPageview']);

  (function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
  </body>
</html>