<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhml"
      xmlns:fb="http://ogp.me/ns/fb#"
      xml:lang="en" lang="en">

  <head>
    <title>ngokevin | AngularJS Directive for Mobile Sliders</title>
    <link rel="stylesheet" type="text/css" href="/css/bundle.css" />
    <link href='http://fonts.googleapis.com/css?family=Ubuntu:400,500,700' rel='stylesheet' type='text/css'>
    <link rel="icon" type="image/x-icon" href="/img/favicon.ico?v=5"/>
    <meta name="viewport" content="width=device-width">
    
  <link rel="stylesheet" type="text/css" href="/css/page.css" />
  
    <meta property="og:image" content="http://i.imgur.com/JM0yS3I.jpg"/>
  
  <meta property="og:description" content="Value: {{ sliderVal || 9001 }} For a five-part introduction to AngularJS, check out ng-okevin&#39;s Angular. I ditched jQuery Mobile&#39;s sliders for my growing AngularJS poker app. It had served as the app&#39;s poker bet slider. All I wanted was a simple slider widget from jQuery Mobile, but the UI framework wanted me to marry it in return. It had its way with my HTML markup, littering my DOM elements with selfish classes and attributes, like an open garbage truck on the freeway. My CSS rules felt oppressed like liberal college students as jQuery Mobile&#39;s CSS files applied forceful rules my top-level html and body elements. The kicker? The slider quickly became deprecated, not working on newer versions of Firefox. Never even saw it work on Chrome. AngularJS Directives My disappointment digresses. The point is: I assembled my own customizable mobile slider that hooked into AngularJS in the form of a directive. Let us begin with the HTML, which AngularJS enhances with declarative two-way bindings. &lt;div slider class=&#34;slider&#34; min=&#34;0&#34; max=&#34;9001&#34; step=&#34;10&#34;&gt; &lt;span&gt;&lt;/span&gt; &lt;/div&gt; Unfortunately, this is not the most exciting display of AngularJS&#39;s abilities. Though by giving the element my slider attribute, I make the element a template for our AngularJS directive named slider, which is where all the magic will happen. There are other ways to syntactically bind the directive to the element through the restrict parameter, we even make it look like a &lt;slider&gt; tag. Note that the following Javascript code snippets are parts of a whole. var myApp = angular.module(&#39;my-app&#39;,[&#39;my-app.directives&#39;]); var directives = angular.module(&#39;my-app.directives&#39;, []); directives.directive(&#39;slider&#39;, function() { return { link: function(scope, element, attrs) { // Linking function. // {{ initialize }} // {{ event handler }} // {{ scope updater }} // {{ scope watcher }} } }; }); Directives teach HTML new tricks, allowing us to write reusable components and widgets. The link function allows us to register event handlers and watches on the scope, all binded to our template. link supplies the AngularJS scope, the element acting as the directive template, and attributes of the element. Initialize Let us get some initialization out of the way. // Linking function. var $element = $(element); var $bar = $(&#39;span&#39;, $element); var step = attrs.step; var width; var offset; var mouseDown = false; element.on(&#39;mousedown touchstart&#39;, function(evt) { mouseDown = true; if (!width) { width = $element.width(); } if (!offset) { offset = $bar.offset().left; } }); element.on(&#39;mouseup touchend&#39;, function(evt) { mouseDown = false; }); This just allows us to determine whether the user is currently dragging the slider with a click or touch. Event Handler Whenever the user drags the slider, we want to update its binded scope value. Vice-versa, whenever the binded scope value changes, we want to visually update the slider&#39;s fill. // Throttle function to 1 call per 25ms for performance. element.on(&#39;mousemove touchmove&#39;, _.throttle(function(evt) { if (!mouseDown) { // Don&#39;t drag the slider on mousemove hover, only on click-n-drag. return; } // Calculate distance of the cursor/finger from beginning of slider var diff; if (evt.pageX) { diff = evt.pageX - offset; } else { diff = evt.originalEvent.touches[0].pageX - offset; } Above is the math driving the slider. We want to calculate how far the slider is dragged relative to the max value of the slider, in terms of a percentage. Scope Updater We then take that percentage of the max value to attain the slider&#39;s value. That value is then applied to the scope. // Allow dragging past the limits of the slider, but impose min/max values. if (diff &lt; 0) { scope.sliderValue = attrs.min; $bar.width(&#39;0%&#39;); } else if (diff &gt; width) { scope.sliderValue = attrs.max; $bar.width(&#39;100%&#39;); // Set the value to percentage of slider filled against a max value. } else { var percent = diff / width; $bar.width(percent * 100 + &#39;%&#39;); scope.sliderValue = Math.round(percent * attrs.max / step) * step); } // Let all the watchers know we have updated the slider value. scope.$apply(); }, 25)); We have enough to calculate the slider&#39;s value. We set the width of the inner span to create the visual effect of the slider, and update the scope&#39;s slider value. Scope Watcher This accomplishes one-way data binding; if we change the slider, we change the slider&#39;s value in the scope. But we also need to account for if the slider&#39;s value in the scope is changed somewhere else, we need to visually update the slider. We accomplish this by registering a watcher on the scope. scope.$watch(&#39;sliderValue&#39;, function(sliderValue) { $bar.width(sliderValue / attrs.max * 100 + &#39;%&#39;); }); When the slider&#39;s value in the scope is updated somewhere else, the watcher will trigger our callback function. We change the slider&#39;s fill percentage to respectively match the new slider value. CSS Setting the width of the inner span changes the fill of the slider. .slider { @include box-shadow(inset 0 -1px 1px rgba(255,255,255,0.3)); background: rgb(10, 10, 10) border-radius: 5px; height: 20px; padding: 10px; position: relative; &gt; span { @include gradient(rgb(43,194,83) 37%, rgb(84,240,84) 69%); @include box-shadow( inset 0 2px 9px rgba(255,255,255,0.3)\, inset 0 -2px 6px rgba(0,0,0,0.4) ); background-color: rgb(43,194,83); border-radius: 20px 8px 8px 20px; font-weight: bold; display: block; height: 100%; overflow: hidden; position: relative; } } To view the code, inspect the code for this page as I inlined it in the HTML. Up Next By now you might have started on your own sweet AngularJS app. But testing is an important part of development. How to test such an opinionated framework? Check out my post on Mock Unit Testing AngularJS Services with Karma and Jasmine. demo = angular.module(&#39;demo&#39;,[&#39;demo.directives&#39;]); angular.module(&#39;demo.directives&#39;, []).directive(&#39;slider&#39;, function() { return { link: function(scope, element, attrs) { var $element = $(element); var width = $element.width(); var $bar = $(&#39;span&#39;, $element); var offset = $bar.offset().left; var mouseDown = false; element.on(&#39;mousedown touchstart&#39;, function(evt) { mouseDown = true; }); element.on(&#39;mouseup touchend&#39;, function(evt) { mouseDown = false; }); element.on(&#39;mousemove touchmove&#39;, _.throttle(function(evt) { evt.preventDefault(); if (!mouseDown) { return; } var diff; if (evt.pageX) { diff = evt.pageX - offset; } else { diff = evt.originalEvent.touches[0].pageX - offset; } if (diff width) { scope.sliderVal = attrs.max; $bar.width(&#39;100%&#39;); } else { var percent = diff / width; $bar.width(percent * 100 + &#39;%&#39;); scope.sliderVal = ( Math.round(percent * attrs.max / attrs.step) * attrs.step); } scope.$apply(); }, 25)); scope.$watch(&#39;sliderVal&#39;, function(sliderVal) { $bar.width(sliderVal / attrs.max * 100 + &#39;%&#39;); }); } }; }); demo.run(); .slider { -moz-box-shadow: inset 0 -1px 1px rgba(255, 255, 255, 0.3); -webkit-box-shadow: inset 0 -1px 1px rgba(255, 255, 255, 0.3); box-shadow: inset 0 -1px 1px rgba(255, 255, 255, 0.3); background: rgb(10, 10, 10); border-radius: 5px; height: 20px; padding: 10px; position: relative; } .slider &gt; span { background-color: #54f054 69%; background-image: -webkit-gradient(linear, left bottom, left top, from(#2bc253 37%), to(#54f054 69%)); background-image: -webkit-linear-gradient(#2bc253 37%, #54f054 69%); background-image: -moz-linear-gradient(#2bc253 37%, #54f054 69%); background-image: -ms-linear-gradient(#2bc253 37%, #54f054 69%); background-image: -o-linear-gradient(#2bc253 37%, #54f054 69%); background-image: linear-gradient(#2bc253 37%, #54f054 69%); -moz-box-shadow: inset 0 2px 9px rgba(255, 255, 255, 0.3) \, inset 0 -2px 6px rgba(0, 0, 0, 0.4); -webkit-box-shadow: inset 0 2px 9px rgba(255, 255, 255, 0.3) \, inset 0 -2px 6px rgba(0, 0, 0, 0.4); box-shadow: inset 0 2px 9px rgba(255, 255, 255, 0.3) \, inset 0 -2px 6px rgba(0, 0, 0, 0.4); background-color: #2bc253; border-radius: 20px 8px 8px 20px; font-weight: bold; display: block; height: 100%; overflow: hidden; position: relative; }"/>

  </head>

  <body>
    <div id="wrap" class="c">
      <header>
        <div class="logos">
          <h1 id="logo">
            <a href='/'>ngo<strong>kevin</strong></a>
            <span class="social">
              <a href="mailto:me@ngokevin.com"><i class="fa fa-envelope"></i></a>
              <a href="http://twitter.com/andgokevin"><i class="fa fa-twitter-square"></i></a>
              <a href="http://github.com/ngokevin"><i class="fa fa-github-square"></i></a>
              <a type="application/rss+xml" href="/rss"><i class="fa fa-rss-square"></i></a>
            </span>
          </h1>
          <span id="sublogo">virtual reality developer at mozilla</span>
          <ul class="blog-tags">
            
              <li>
                <a href="/blog/tags/code/"
                   >
                  Code</a>
              </li>
            
              <li>
                <a href="/blog/tags/life/"
                   >
                  Life</a>
              </li>
            
              <li>
                <a href="/blog/tags/photography/"
                   >
                  Shoot</a>
              </li>
            
              <li>
                <a href="/blog/tags/poker/"
                   >
                  Poker</a>
              </li>
            
          </ul>
        </div>

        <nav>
          
            <a href="/about/">
              <span>
                About</span>
            </a>
          
            <a href="/">
              <span>
                Write</span>
            </a>
          
            <a href="/photography/">
              <span>
                Shoot</span>
            </a>
          
        </nav>
      </header>

      <div class="main">
        <div class="header-group">
  <div class="blog">
    <h1>AngularJS Directive for Mobile Sliders</h1>

    <p class="metadata">
      
        Thursday April 11, 2013
      
    </p>
  </div>

  <div id="top-share" class="addthis_toolbox addthis_default_style">
  <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
  <a class="addthis_button_tweet"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-513af3cd5e69b4ae"></script>
</div>

        <div class="base-image">
          
            <div class="page_pic top">
              <img src="http://i.imgur.com/JM0yS3I.jpg">
              
            </div>
          
        </div>

        
  <div class="page c">
    <div ng-app="demo" class="demo" style="margin-bottom: 26px;">
  <b>Value:</b> <span>{{ sliderVal || 9001 }}</span>
  <div slider class="slider" min="0" max="9001" step="10"><span></span></div>
</div>

<p>For a five-part introduction to AngularJS, check out <a href="/blog/angular-1">ng-okevin's
Angular</a>.</p>
<p>I ditched jQuery Mobile's sliders for my growing AngularJS <a href="http://github.com/ngokevin/underthegun">poker
app</a>. It had served as the app's poker
bet slider. All I wanted was a simple slider widget from jQuery Mobile, but the
UI framework wanted me to marry it in return. It had its way with my HTML
markup, littering my DOM elements with selfish classes and attributes, like
an open garbage truck on the freeway. My CSS rules felt oppressed like liberal
college students as jQuery Mobile's CSS files applied forceful rules my
top-level <code>html</code> and <code>body</code> elements. The kicker? The slider quickly
became deprecated, not working on newer versions of Firefox.  Never even saw it
work on Chrome.</p>
<h2 id="angularjs-directives">AngularJS Directives</h2>
<p>My disappointment digresses. The point is: I assembled my own customizable
mobile slider that hooked into AngularJS in the form of a directive. Let us
begin with the HTML, which AngularJS enhances with declarative two-way bindings.</p>
<div class="highlight"><pre><span class="p">&lt;</span><span class="nt">div</span> <span class="na">slider</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;slider&quot;</span> <span class="na">min</span><span class="o">=</span><span class="s">&quot;0&quot;</span> <span class="na">max</span><span class="o">=</span><span class="s">&quot;9001&quot;</span> <span class="na">step</span><span class="o">=</span><span class="s">&quot;10&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>


<p>Unfortunately, this is not the most exciting display of AngularJS's abilities.
Though by giving the element my <code>slider</code> attribute, I make the element a
template for our AngularJS directive named <code>slider</code>, which is where all the
magic will happen. There are other ways to syntactically bind the directive to
the element through the <code>restrict</code> parameter, we even make it look like a
<code>&lt;slider&gt;</code> tag. Note that the following Javascript code snippets are parts
of a whole.</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">myApp</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;my-app&#39;</span><span class="p">,[</span><span class="s1">&#39;my-app.directives&#39;</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">directives</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;my-app.directives&#39;</span><span class="p">,</span> <span class="p">[]);</span>
<span class="nx">directives</span><span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="s1">&#39;slider&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="nx">link</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Linking function.</span>
            <span class="c1">// {{ initialize }}</span>
            <span class="c1">// {{ event handler }}</span>
            <span class="c1">// {{ scope updater }}</span>
            <span class="c1">// {{ scope watcher }}</span>
        <span class="p">}</span>
    <span class="p">};</span>
<span class="p">});</span>
</pre></div>


<p>Directives teach HTML new tricks, allowing us to write reusable components and
widgets. The link function allows us to register event handlers and watches on
the scope, all binded to our template. <code>link</code> supplies the AngularJS scope,
the element acting as the directive template, and attributes of the element.</p>
<h2 id="initialize">Initialize</h2>
<p>Let us get some initialization out of the way.</p>
<div class="highlight"><pre><span class="c1">// Linking function.</span>
<span class="kd">var</span> <span class="nx">$element</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">$bar</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,</span> <span class="nx">$element</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">step</span> <span class="o">=</span> <span class="nx">attrs</span><span class="p">.</span><span class="nx">step</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">width</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">offset</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">mouseDown</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nx">element</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;mousedown touchstart&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">mouseDown</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">width</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">width</span> <span class="o">=</span> <span class="nx">$element</span><span class="p">.</span><span class="nx">width</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">offset</span> <span class="o">=</span> <span class="nx">$bar</span><span class="p">.</span><span class="nx">offset</span><span class="p">().</span><span class="nx">left</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="nx">element</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;mouseup touchend&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">mouseDown</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>


<p>This just allows us to determine whether the user is currently dragging the
slider with a click or touch.</p>
<h2 id="event-handler">Event Handler</h2>
<p>Whenever the user drags the slider, we want to update its binded scope value.
Vice-versa, whenever the binded scope value changes, we want to visually
update the slider's fill.</p>
<div class="highlight"><pre><span class="c1">// Throttle function to 1 call per 25ms for performance.</span>
<span class="nx">element</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;mousemove touchmove&#39;</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">throttle</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">mouseDown</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Don&#39;t drag the slider on mousemove hover, only on click-n-drag.</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Calculate distance of the cursor/finger from beginning of slider</span>
    <span class="kd">var</span> <span class="nx">diff</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">pageX</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">diff</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">pageX</span> <span class="o">-</span> <span class="nx">offset</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">diff</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">.</span><span class="nx">touches</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">pageX</span> <span class="o">-</span> <span class="nx">offset</span><span class="p">;</span>
    <span class="p">}</span>
</pre></div>


<p>Above is the math driving the slider. We want to calculate how far the slider
is dragged relative to the max value of the slider, in terms of a percentage.</p>
<h2 id="scope-updater">Scope Updater</h2>
<p>We then take that percentage of the max value to attain the slider's value.
That value is then applied to the scope.</p>
<div class="highlight"><pre>    <span class="c1">// Allow dragging past the limits of the slider, but impose min/max values.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">scope</span><span class="p">.</span><span class="nx">sliderValue</span> <span class="o">=</span> <span class="nx">attrs</span><span class="p">.</span><span class="nx">min</span><span class="p">;</span>
        <span class="nx">$bar</span><span class="p">.</span><span class="nx">width</span><span class="p">(</span><span class="s1">&#39;0%&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">diff</span> <span class="o">&gt;</span> <span class="nx">width</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">scope</span><span class="p">.</span><span class="nx">sliderValue</span> <span class="o">=</span> <span class="nx">attrs</span><span class="p">.</span><span class="nx">max</span><span class="p">;</span>
        <span class="nx">$bar</span><span class="p">.</span><span class="nx">width</span><span class="p">(</span><span class="s1">&#39;100%&#39;</span><span class="p">);</span>

    <span class="c1">// Set the value to percentage of slider filled against a max value.</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">percent</span> <span class="o">=</span> <span class="nx">diff</span> <span class="o">/</span> <span class="nx">width</span><span class="p">;</span>
        <span class="nx">$bar</span><span class="p">.</span><span class="nx">width</span><span class="p">(</span><span class="nx">percent</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span><span class="p">);</span>
        <span class="nx">scope</span><span class="p">.</span><span class="nx">sliderValue</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">percent</span> <span class="o">*</span> <span class="nx">attrs</span><span class="p">.</span><span class="nx">max</span> <span class="o">/</span> <span class="nx">step</span><span class="p">)</span> <span class="o">*</span> <span class="nx">step</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Let all the watchers know we have updated the slider value.</span>
    <span class="nx">scope</span><span class="p">.</span><span class="nx">$apply</span><span class="p">();</span>
<span class="p">},</span> <span class="mi">25</span><span class="p">));</span>
</pre></div>


<p>We have enough to calculate the slider's value. We set the width of the inner
span to create the visual effect of the slider, and update the scope's slider
value.</p>
<h2 id="scope-watcher">Scope Watcher</h2>
<p>This accomplishes one-way data binding; if we change the slider, we
change the slider's value in the scope. But we also need to account for if the
slider's value in the scope is changed somewhere else, we need to visually
update the slider. We accomplish this by registering a watcher on the scope.</p>
<div class="highlight"><pre><span class="nx">scope</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span><span class="s1">&#39;sliderValue&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sliderValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$bar</span><span class="p">.</span><span class="nx">width</span><span class="p">(</span><span class="nx">sliderValue</span> <span class="o">/</span> <span class="nx">attrs</span><span class="p">.</span><span class="nx">max</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>


<p>When the slider's value in the scope is updated somewhere else, the watcher
will trigger our callback function. We change the slider's fill percentage to
respectively match the new slider value.</p>
<h2 id="css">CSS</h2>
<p>Setting the width of the inner span changes the fill of the slider.</p>
<div class="highlight"><pre><span class="nc">.slider</span> <span class="p">{</span>
    <span class="k">@include</span><span class="nd"> box-shadow</span><span class="p">(</span><span class="no">inset</span> <span class="mi">0</span> <span class="mi">-1</span><span class="kt">px</span> <span class="mi">1</span><span class="kt">px</span> <span class="nf">rgba</span><span class="p">(</span><span class="mi">255</span><span class="o">,</span><span class="mi">255</span><span class="o">,</span><span class="mi">255</span><span class="o">,</span><span class="mi">0</span><span class="mf">.3</span><span class="p">));</span>
    <span class="nt">background</span><span class="nd">:</span> <span class="nt">rgb</span><span class="o">(</span><span class="nt">10</span><span class="o">,</span> <span class="nt">10</span><span class="o">,</span> <span class="nt">10</span><span class="o">)</span>
    <span class="nt">border-radius</span><span class="nd">:</span> <span class="nt">5px</span><span class="o">;</span>
    <span class="nt">height</span><span class="nd">:</span> <span class="nt">20px</span><span class="o">;</span>
    <span class="nt">padding</span><span class="nd">:</span> <span class="nt">10px</span><span class="o">;</span>
    <span class="nt">position</span><span class="nd">:</span> <span class="nt">relative</span><span class="o">;</span>
    <span class="o">&gt;</span> <span class="nt">span</span> <span class="p">{</span>
        <span class="k">@include</span><span class="nd"> gradient</span><span class="p">(</span><span class="nf">rgb</span><span class="p">(</span><span class="mi">43</span><span class="o">,</span><span class="mi">194</span><span class="o">,</span><span class="mi">83</span><span class="p">)</span> <span class="mi">37</span><span class="kt">%</span><span class="o">,</span> <span class="nf">rgb</span><span class="p">(</span><span class="mi">84</span><span class="o">,</span><span class="mi">240</span><span class="o">,</span><span class="mi">84</span><span class="p">)</span> <span class="mi">69</span><span class="kt">%</span><span class="p">);</span>
        <span class="k">@include</span><span class="nd"> box-shadow</span><span class="p">(</span>
            <span class="no">inset</span> <span class="mi">0</span> <span class="mi">2</span><span class="kt">px</span> <span class="mi">9</span><span class="kt">px</span>  <span class="nf">rgba</span><span class="p">(</span><span class="mi">255</span><span class="o">,</span><span class="mi">255</span><span class="o">,</span><span class="mi">255</span><span class="o">,</span><span class="mi">0</span><span class="mf">.3</span><span class="p">)</span><span class="err">\</span><span class="o">,</span>
            <span class="no">inset</span> <span class="mi">0</span> <span class="mi">-2</span><span class="kt">px</span> <span class="mi">6</span><span class="kt">px</span> <span class="nf">rgba</span><span class="p">(</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="mf">.4</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="nt">background-color</span><span class="nd">:</span> <span class="nt">rgb</span><span class="o">(</span><span class="nt">43</span><span class="o">,</span><span class="nt">194</span><span class="o">,</span><span class="nt">83</span><span class="o">);</span>
        <span class="nt">border-radius</span><span class="nd">:</span> <span class="nt">20px</span> <span class="nt">8px</span> <span class="nt">8px</span> <span class="nt">20px</span><span class="o">;</span>
        <span class="nt">font-weight</span><span class="nd">:</span> <span class="nt">bold</span><span class="o">;</span>
        <span class="nt">display</span><span class="nd">:</span> <span class="nt">block</span><span class="o">;</span>
        <span class="nt">height</span><span class="nd">:</span> <span class="nt">100</span><span class="err">%</span><span class="o">;</span>
        <span class="nt">overflow</span><span class="nd">:</span> <span class="nt">hidden</span><span class="o">;</span>
        <span class="nt">position</span><span class="nd">:</span> <span class="nt">relative</span><span class="o">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>To view the code, inspect the code for this page as I inlined it in the HTML.</p>
<h2 id="up-next">Up Next</h2>
<p>By now you might have started on your own sweet AngularJS app. But testing is
an important part of development. How to test such an opinionated framework?
Check out my post on <a href="/blog/angular-unit-testing">Mock Unit Testing AngularJS Services with Karma and
Jasmine</a>.</p>
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.3/angular.min.js"></script>

<script src="http://underscorejs.org/underscore-min.js"></script>

<script type="text/javascript">
    demo = angular.module('demo',['demo.directives']);
    angular.module('demo.directives', []).directive('slider', function() {
        return {
            link: function(scope, element, attrs) {

                var $element = $(element);
                var width = $element.width();
                var $bar = $('span', $element);
                var offset = $bar.offset().left;

                var mouseDown = false;
                element.on('mousedown touchstart', function(evt) {
                    mouseDown = true;
                });

                element.on('mouseup touchend', function(evt) {
                    mouseDown = false;
                });

                element.on('mousemove touchmove', _.throttle(function(evt) {
                    evt.preventDefault();
                    if (!mouseDown) {
                        return;
                    }
                    var diff;
                    if (evt.pageX) {
                        diff = evt.pageX - offset;
                    } else {
                        diff = evt.originalEvent.touches[0].pageX - offset;
                    }

                    if (diff < 0) {
                        scope.sliderVal = attrs.min;
                        $bar.width('0%');
                    } else if (diff > width) {
                        scope.sliderVal = attrs.max;
                        $bar.width('100%');
                    } else {
                        var percent = diff / width;
                        $bar.width(percent * 100 + '%');
                        scope.sliderVal = (
                            Math.round(percent * attrs.max / attrs.step) *
                            attrs.step);
                    }
                    scope.$apply();
                }, 25));

                scope.$watch('sliderVal', function(sliderVal) {
                    $bar.width(sliderVal / attrs.max * 100 + '%');
                });
            }
        };
    });
    demo.run();
</script>

<style>
    .slider {
        -moz-box-shadow: inset 0 -1px 1px rgba(255, 255, 255, 0.3);
        -webkit-box-shadow: inset 0 -1px 1px rgba(255, 255, 255, 0.3);
        box-shadow: inset 0 -1px 1px rgba(255, 255, 255, 0.3);
        background: rgb(10, 10, 10);
        border-radius: 5px;
        height: 20px;
        padding: 10px;
        position: relative;
    }
    .slider > span {
        background-color: #54f054 69%;
        background-image: -webkit-gradient(linear, left bottom, left top, from(#2bc253 37%), to(#54f054 69%));
        background-image: -webkit-linear-gradient(#2bc253 37%, #54f054 69%);
        background-image: -moz-linear-gradient(#2bc253 37%, #54f054 69%);
        background-image: -ms-linear-gradient(#2bc253 37%, #54f054 69%);
        background-image: -o-linear-gradient(#2bc253 37%, #54f054 69%);
        background-image: linear-gradient(#2bc253 37%, #54f054 69%);
        -moz-box-shadow: inset 0 2px 9px rgba(255, 255, 255, 0.3) \, inset 0 -2px 6px rgba(0, 0, 0, 0.4);
        -webkit-box-shadow: inset 0 2px 9px rgba(255, 255, 255, 0.3) \, inset 0 -2px 6px rgba(0, 0, 0, 0.4);
        box-shadow: inset 0 2px 9px rgba(255, 255, 255, 0.3) \, inset 0 -2px 6px rgba(0, 0, 0, 0.4);
        background-color: #2bc253;
        border-radius: 20px 8px 8px 20px;
        font-weight: bold;
        display: block;
        height: 100%;
        overflow: hidden;
        position: relative;
    }
</style>
  </div>

  <p class="end-sect">&sect;</p>
  <div id="bottom-share" class="addthis_toolbox addthis_default_style">
  <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
  <a class="addthis_button_tweet"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-513af3cd5e69b4ae"></script>
   <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'ngokevin'; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
           var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
           dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
           (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
  <script src="https://cdn.jsdelivr.net/anchorjs/3.0.0/anchor.min.js"></script>
  <script>anchors.add('h2, h3, h4, h5, h6');</script>

      </div>
    </div>

    <div id="footer">
      <a href="mailto:me@ngokevin.com"><i class="fa fa-envelope"></i></a>
      <a href="http://twitter.com/ngokevin_"><i class="fa fa-twitter-square"></i></a>
      <a href="http://github.com/ngokevin"><i class="fa fa-github-square"></i></a>
      <a type="application/rss+xml" href="/rss/index.xml"><i class="fa fa-rss-square"></i></a>
    </div>

     <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-29871909-1']);
  _gaq.push(['_trackPageview']);

  (function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
  </body>
</html>