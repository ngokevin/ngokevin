<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhml"
      xmlns:fb="http://ogp.me/ns/fb#"
      xml:lang="en" lang="en">

  <head>
    <title>ngokevin | Bootstrapping CRUD-Heavy Django Apps with CBVs</title>
    <link rel="stylesheet" type="text/css" href="/css/bundle.css" />
    <link href='http://fonts.googleapis.com/css?family=Ubuntu:400,500,700' rel='stylesheet' type='text/css'>
    <link rel="icon" type="image/x-icon" href="/img/favicon.ico?v=5"/>
    <meta name="viewport" content="width=device-width">
    
  <link rel="stylesheet" type="text/css" href="/css/page.css" />
  
  <meta property="og:description" content="CRUD-heavy web applications usually implement similar operations on many similar objects. It is especially important to practice DRY (don&#39;t repeat yourself) in these kinds of codebases. Maintaining code becomes much easier by having a generic base code that can be subclassed or extended to fulfill specific needs. Using these concepts can simplify code down to zero-LOC templates and zero-LOC views. Django Class-Based Generic Views Django class-based generic views (CBVs) are like a set of prebuilt views that ships with a lot of commonly used features that can easily be overidden. For example, TemplateView, the most basic CBV simply displays a template which is simple enough to place in the urls.py. # urls.py from django.views.generic import TemplateView urlpatterns = patterns(&#39;&#39;, url(r&#39;^$&#39;, TemplateView.as_view(template_name=&#39;index.html&#39;)) ) When we point our urls.py towards a view, we invoke the as_view function to sort of turn the class into a view. For a CRUD app, there are several very useful generic views. django.views.generic.list.ListView django.views.generic.detail.DetailView django.views.generic.edit.CreateView django.views.generic.edit.UpdateView django.views.generic.edit.DeleteView Implementing a Generic View Since the generic views have a lot in similar in the way they&#39;re used, we&#39;ll use ListView as an example. Since this is a post about inheritance, let&#39;s create a base ListView that other apps&#39; ListViews can inherit from. # base/views.py from django.views.generic import ListView class BaseListView(ListView): template_name = &#39;base/base_list.html&#39; paginate_by = 30 And that&#39;s it! Short, right? It could be even shorter by omitting the template_name variable; the CBVs by default look for a template at APPNAME/APPNAME_VIEWNAME if not template name is given. So for this ListView in the base app, it would look at &#39;base/base_list.html&#39;, and DetailView would look at &#39;base/base_detail.html&#39; and so on. In the urls.py, simply import the view and call as_view() on it like with the TemplateView before. Writing the Template For ListView, if paginate_by is defined, Django will paginate the list of objects if necessary. In the template, we can refer to the list of objects with object_list and the pagination object as &#39;page_obj&#39;. Ignore the my_header for now. {% extends &#34;base.html&#34; %} {% block title %} Generic Objects {% endblock %} &lt;h1&gt; {% block header %} {{ my_header }} {% endblock %} &lt;/h1&gt; {% if page_obj.has_next() %} &lt;a href=&#34;?page={{ page_obj.next_page_number() }}&#34;Next&lt;/a&gt; {% endif %} {% for obj in object_list %} {{ obj }} {% endfor %} Extending our BaseListView Take for example an app called books that lets us CRUD books in a database. Let&#39;s use our BaseListView to create a ListView for books. # book/views.py from app.base.views import BaseListView from app.book.models import Book class BookView(object): model = Book queryset = Book.objects.all() class BookListView(BookView, BaseListView): &#34;&#34;&#34; &#34;&#34;&#34; We can even get away with only this but we say we want to specify some fine-grained details. Let&#39;s add a context variable to access in the template. # book/views.py class BookListView(BookView, BaseListView): def get_context_data(self, **kwargs: context = super(BaseListView, self).get_context_data(**kwargs) context[&#39;my_header&#39;] = &#39;List of Books&#39; return context We overwrote the parent&#39;s get_context_data which contains the variables to be passed into the templates to add another variable. Here, we&#39;ll add an arbitrary name for the page header. Now we can leave it and have it point to the base list template we wrote earlier, or we can have it look for it within the books app. Paired along with template inheritance, we barely have to write any code once the infrastructure is set up. {% extends &#34;base.html&#34; %} {% block title %} Books {% endblock %} Django CBVs have been in the dark for some time and are becoming increasingly popular. Throw away all of those function-based views that seem very similar to each other and go generic."/>

  </head>

  <body>
    <div id="wrap" class="c">
      <header>
        <div class="logos">
          <h1 id="logo">
            <a href='/'>ngo<strong>kevin</strong></a>
            <span class="social">
              <a href="mailto:me@ngokevin.com"><i class="fa fa-envelope"></i></a>
              <a href="http://twitter.com/andgokevin"><i class="fa fa-twitter-square"></i></a>
              <a href="http://github.com/ngokevin"><i class="fa fa-github-square"></i></a>
              <a type="application/rss+xml" href="/rss"><i class="fa fa-rss-square"></i></a>
            </span>
          </h1>
          <span id="sublogo">virtual reality developer at mozilla</span>
          <ul class="blog-tags">
            
              <li>
                <a href="/blog/tags/code/"
                   >
                  Code</a>
              </li>
            
              <li>
                <a href="/blog/tags/life/"
                   >
                  Life</a>
              </li>
            
              <li>
                <a href="/blog/tags/photography/"
                   >
                  Shoot</a>
              </li>
            
              <li>
                <a href="/blog/tags/poker/"
                   >
                  Poker</a>
              </li>
            
          </ul>
        </div>

        <nav>
          
            <a href="/about/">
              <span>
                About</span>
            </a>
          
            <a href="/">
              <span>
                Write</span>
            </a>
          
            <a href="/photography/">
              <span>
                Shoot</span>
            </a>
          
        </nav>
      </header>

      <div class="main">
        <div class="header-group">
  <div class="blog">
    <h1>Bootstrapping CRUD-Heavy Django Apps with CBVs</h1>

    <p class="metadata">
      
        Sunday April 22, 2012
      
    </p>
  </div>

  <div id="top-share" class="addthis_toolbox addthis_default_style">
  <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
  <a class="addthis_button_tweet"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-513af3cd5e69b4ae"></script>
</div>

        <div class="base-image">
          
        </div>

        
  <div class="page c">
    <p>CRUD-heavy web applications usually implement similar operations on many
similar objects. It is especially important to practice DRY (don't repeat
yourself) in these kinds of codebases. Maintaining code becomes much easier
by having a generic base code that can be subclassed or extended to fulfill
specific needs. Using these concepts can simplify code down to zero-LOC
templates and zero-LOC views.</p>
<h2 id="django-class-based-generic-views">Django Class-Based Generic Views</h2>
<p>Django class-based generic views (CBVs) are like a set of prebuilt views
that ships with a lot of commonly used features that can easily be
overidden. For example, TemplateView, the most basic CBV simply displays a
template which is simple enough to place in the urls.py.</p>
<div class="highlight"><pre><span class="c1"># urls.py</span>
<span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="kn">import</span> <span class="n">TemplateView</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="n">url</span><span class="p">(</span><span class="s1">r&#39;^$&#39;</span><span class="p">,</span> <span class="n">TemplateView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span><span class="n">template_name</span><span class="o">=</span><span class="s1">&#39;index.html&#39;</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>


<p>When we point our urls.py towards a view, we invoke the <em>as_view</em> function
to sort of turn the class into a view. For a CRUD app, there are several
very useful generic views.</p>
<ul>
<li>django.views.generic.list.ListView</li>
<li>django.views.generic.detail.DetailView</li>
<li>django.views.generic.edit.CreateView</li>
<li>django.views.generic.edit.UpdateView</li>
<li>django.views.generic.edit.DeleteView</li>
</ul>
<h2 id="implementing-a-generic-view">Implementing a Generic View</h2>
<p>Since the generic views have a lot in similar in the way they're used,
we'll use ListView as an example. Since this is a post about inheritance,
let's create a base ListView that other apps' ListViews can inherit from.</p>
<div class="highlight"><pre><span class="c1"># base/views.py</span>
<span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="kn">import</span> <span class="n">ListView</span>

<span class="k">class</span> <span class="nc">BaseListView</span><span class="p">(</span><span class="n">ListView</span><span class="p">):</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;base/base_list.html&#39;</span>
    <span class="n">paginate_by</span> <span class="o">=</span> <span class="mi">30</span>
</pre></div>


<p><strong>And that's it!</strong> Short, right? It could be even shorter by omitting the
<em>template_name</em> variable; the CBVs by default look for a template at
<em>APPNAME/APPNAME_VIEWNAME</em> if not template name is given. So for this
ListView in the base app, it would look at 'base/base_list.html', and
DetailView would look at 'base/base_detail.html' and so on.</p>
<p>In the urls.py, simply import the view and call <em>as_view()</em> on it like with
the TemplateView before.</p>
<h2 id="writing-the-template">Writing the Template</h2>
<p>For ListView, if paginate_by is defined, Django will paginate the list of
objects if necessary. In the template, we can refer to the list of objects
with <em>object_list</em> and the pagination object as 'page_obj'. Ignore the
<em>my_header</em> for now.</p>
<div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">&quot;base.html&quot;</span> <span class="cp">%}</span><span class="x"></span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    Generic Objects</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="x"></span>

<span class="x">&lt;h1&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">header</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">        </span><span class="cp">{{</span> <span class="nv">my_header</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">&lt;/h1&gt;</span>

<span class="cp">{%</span> <span class="k">if</span> <span class="nv">page_obj.has_next</span><span class="o">()</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    &lt;a href=&quot;?page=</span><span class="cp">{{</span> <span class="nv">page_obj.next_page_number</span><span class="o">()</span> <span class="cp">}}</span><span class="x">&quot;Next&lt;/a&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>

<span class="cp">{%</span> <span class="k">for</span> <span class="nv">obj</span> <span class="k">in</span> <span class="nv">object_list</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    </span><span class="cp">{{</span> <span class="nv">obj</span> <span class="cp">}}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>


<h2 id="extending-our-baselistview">Extending our BaseListView</h2>
<p>Take for example an app called <em>books</em> that lets us CRUD books in a
database. Let's use our BaseListView to create a ListView for books.</p>
<div class="highlight"><pre><span class="c1"># book/views.py</span>
<span class="kn">from</span> <span class="nn">app.base.views</span> <span class="kn">import</span> <span class="n">BaseListView</span>
<span class="kn">from</span> <span class="nn">app.book.models</span> <span class="kn">import</span> <span class="n">Book</span>

<span class="k">class</span> <span class="nc">BookView</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Book</span>
    <span class="n">queryset</span> <span class="o">=</span> <span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">BookListView</span><span class="p">(</span><span class="n">BookView</span><span class="p">,</span> <span class="n">BaseListView</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
</pre></div>


<p>We can even get away with only this but we say we want to specify some
fine-grained details.  Let's add a context variable to access in the
template.</p>
<div class="highlight"><pre><span class="c1"># book/views.py</span>
<span class="k">class</span> <span class="nc">BookListView</span><span class="p">(</span><span class="n">BookView</span><span class="p">,</span> <span class="n">BaseListView</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span>
        <span class="n">context</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">BaseListView</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">context</span><span class="p">[</span><span class="s1">&#39;my_header&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;List of Books&#39;</span>
        <span class="k">return</span> <span class="n">context</span>
</pre></div>


<p>We overwrote the parent's <em>get_context_data</em> which contains the variables
to be passed into the templates to add another variable. Here, we'll add an
arbitrary name for the page header. Now we can leave it and have it point
to the base list template we wrote earlier, or we can have it look for it
within the books app.  Paired along with template inheritance, we barely
have to write any code once the infrastructure is set up.</p>
<div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">&quot;base.html&quot;</span> <span class="cp">%}</span><span class="x"></span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    Books</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>


<p>Django CBVs have been in the dark for some time and are becoming
increasingly popular. Throw away all of those function-based views that
seem very similar to each other and go generic.</p>
  </div>

  <p class="end-sect">&sect;</p>
  <div id="bottom-share" class="addthis_toolbox addthis_default_style">
  <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
  <a class="addthis_button_tweet"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-513af3cd5e69b4ae"></script>
   <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'ngokevin'; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
           var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
           dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
           (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
  <script src="https://cdn.jsdelivr.net/anchorjs/3.0.0/anchor.min.js"></script>
  <script>anchors.add('h2, h3, h4, h5, h6');</script>

      </div>
    </div>

    <div id="footer">
      <a href="mailto:me@ngokevin.com"><i class="fa fa-envelope"></i></a>
      <a href="http://twitter.com/ngokevin_"><i class="fa fa-twitter-square"></i></a>
      <a href="http://github.com/ngokevin"><i class="fa fa-github-square"></i></a>
      <a type="application/rss+xml" href="/rss/index.xml"><i class="fa fa-rss-square"></i></a>
    </div>

     <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-29871909-1']);
  _gaq.push(['_trackPageview']);

  (function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
  </body>
</html>