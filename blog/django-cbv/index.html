<html>
  <head>
    <title>Kevin Ngo</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="CRUD-heavy web applications usually implement similar operations on many similar objects. It is especially important to practice DRY (don’t repeat yourself) in these kinds of codebases. Maintaining...">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="ngokevin.com">
    <meta name="twitter:creator" content="Kevin Ngo">
    <meta name="twitter:title" content="Bootstrapping CRUD-Heavy Django Apps with CBVs">
    <meta name="twitter:description" content="CRUD-heavy web applications usually implement similar operations on many similar objects. It is especially important to practice DRY (don’t repeat yourself) in these kinds of codebases. Maintaining...">
    <meta name="twitter:image" content="">
    <link rel="stylesheet" href="/css/base.css">
    
     <link rel="stylesheet" href="/css/post.css"> 
    <script src="https://use.fontawesome.com/5b235cd0cb.js"></script>
  <link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>
  <body>
    <div class="post">
  
    <a href="/">&laquo; Kevin Ngo</a>
  

  <h1>Bootstrapping CRUD-Heavy Django Apps with CBVs</h1>
  <p>22 Apr 2012</p>

  

  <p>CRUD-heavy web applications usually implement similar operations on many
similar objects. It is especially important to practice DRY (don’t repeat
yourself) in these kinds of codebases. Maintaining code becomes much easier
by having a generic base code that can be subclassed or extended to fulfill
specific needs. Using these concepts can simplify code down to zero-LOC
templates and zero-LOC views.</p>
<hr>
<h2 id="django-class-based-generic-views"><a href="#django-class-based-generic-views" class="headerlink" title="Django Class-Based Generic Views"></a>Django Class-Based Generic Views</h2><p>Django class-based generic views (CBVs) are like a set of prebuilt views
that ships with a lot of commonly used features that can easily be
overidden. For example, TemplateView, the most basic CBV simply displays a
template which is simple enough to place in the urls.py.</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># urls.py</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>views<span class="token punctuation">.</span>generic <span class="token keyword">import</span> TemplateView

urlpatterns <span class="token operator">=</span> patterns<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span>
    url<span class="token punctuation">(</span>r<span class="token string">'^$'</span><span class="token punctuation">,</span> TemplateView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span>template_name<span class="token operator">=</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre>
<p>When we point our urls.py towards a view, we invoke the <em>as_view</em> function
to sort of turn the class into a view. For a CRUD app, there are several
very useful generic views.</p>
<ul>
<li>django.views.generic.list.ListView</li>
<li>django.views.generic.detail.DetailView</li>
<li>django.views.generic.edit.CreateView</li>
<li>django.views.generic.edit.UpdateView</li>
<li>django.views.generic.edit.DeleteView</li>
</ul>
<h2 id="implementing-a-generic-view"><a href="#implementing-a-generic-view" class="headerlink" title="Implementing a Generic View"></a>Implementing a Generic View</h2><p>Since the generic views have a lot in similar in the way they’re used,
we’ll use ListView as an example. Since this is a post about inheritance,
let’s create a base ListView that other apps’ ListViews can inherit from.</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># base/views.py</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>views<span class="token punctuation">.</span>generic <span class="token keyword">import</span> ListView

<span class="token keyword">class</span> <span class="token class-name">BaseListView</span><span class="token punctuation">(</span>ListView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    template_name <span class="token operator">=</span> <span class="token string">'base/base_list.html'</span>
    paginate_by <span class="token operator">=</span> <span class="token number">30</span>
</code></pre>
<p><strong>And that’s it!</strong> Short, right? It could be even shorter by omitting the
<em>template_name</em> variable; the CBVs by default look for a template at
<em>APPNAME/APPNAME_VIEWNAME</em> if not template name is given. So for this
ListView in the base app, it would look at ‘base/base_list.html’, and
DetailView would look at ‘base/base_detail.html’ and so on.</p>
<p>In the urls.py, simply import the view and call <em>as_view()</em> on it like with
the TemplateView before.</p>
<h2 id="writing-the-template"><a href="#writing-the-template" class="headerlink" title="Writing the Template"></a>Writing the Template</h2><p>For ListView, if paginate_by is defined, Django will paginate the list of
objects if necessary. In the template, we can refer to the list of objects
with <em>object_list</em> and the pagination object as ‘page_obj’. Ignore the
<em>my_header</em> for now.</p>
<pre class=" language-jinja"><code class="language-jinja">{% extends "base.html" %}

{% block title %}
    Generic Objects
{% endblock %}

<h1>
    {% block header %}
        {{ my_header }}
    {% endblock %}
</h1>

{% if page_obj.has_next() %}
    <a href="?page={{ page_obj.next_page_number() }}" next<="" a="">
{% endif %}

{% for obj in object_list %}
    {{ obj }}
{% endfor %}
</a></code></pre>
<h2 id="extending-our-baselistview"><a href="#extending-our-baselistview" class="headerlink" title="Extending our BaseListView"></a>Extending our BaseListView</h2><p>Take for example an app called <em>books</em> that lets us CRUD books in a
database. Let’s use our BaseListView to create a ListView for books.</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># book/views.py</span>
<span class="token keyword">from</span> app<span class="token punctuation">.</span>base<span class="token punctuation">.</span>views <span class="token keyword">import</span> BaseListView
<span class="token keyword">from</span> app<span class="token punctuation">.</span>book<span class="token punctuation">.</span>models <span class="token keyword">import</span> Book

<span class="token keyword">class</span> <span class="token class-name">BookView</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>
    model <span class="token operator">=</span> Book
    queryset <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>all<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">BookListView</span><span class="token punctuation">(</span>BookView<span class="token punctuation">,</span> BaseListView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">""" """</span>
</code></pre>
<p>We can even get away with only this but we say we want to specify some
fine-grained details.  Let’s add a context variable to access in the
template.</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># book/views.py</span>
<span class="token keyword">class</span> <span class="token class-name">BookListView</span><span class="token punctuation">(</span>BookView<span class="token punctuation">,</span> BaseListView<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">get_context_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">:</span>
        context <span class="token operator">=</span> super<span class="token punctuation">(</span>BaseListView<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>get_context_data<span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        context<span class="token punctuation">[</span><span class="token string">'my_header'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'List of Books'</span>
        <span class="token keyword">return</span> context
</code></pre>
<p>We overwrote the parent’s <em>get_context_data</em> which contains the variables
to be passed into the templates to add another variable. Here, we’ll add an
arbitrary name for the page header. Now we can leave it and have it point
to the base list template we wrote earlier, or we can have it look for it
within the books app.  Paired along with template inheritance, we barely
have to write any code once the infrastructure is set up.</p>
<pre class=" language-jinja"><code class="language-jinja">{% extends "base.html" %}

{% block title %}
    Books
{% endblock %}
</code></pre>
<p>Django CBVs have been in the dark for some time and are becoming
increasingly popular. Throw away all of those function-based views that
seem very similar to each other and go generic.</p>

</div>


    <div class="social">
      <a href="https://github.com/ngokevin/"><i class="fa fa-github-alt" aria-hidden="true"></i></a>
      <a href="https://twitter.com/andgokevin/"><i class="fa fa-twitter" aria-hidden="true"></i></a>
      <a href="https://instagram.com/andgokevin/"><i class="fa fa-instagram" aria-hidden="true"></i></a>
    </div>

    <script src="https://cdn.jsdelivr.net/blazy/1.8.2/blazy.min.js"></script>
    <script>new Blazy({selector: '.lazyload'});</script>
  </body>
</html>
