<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhml"
      xmlns:fb="http://ogp.me/ns/fb#"
      xml:lang="en" lang="en">

  <head>
    <title>ngokevin | Fending Off a Home Server DDoS</title>
    <link rel="stylesheet" type="text/css" href="/css/bundle.css" />
    <link href='http://fonts.googleapis.com/css?family=Ubuntu:400,500,700' rel='stylesheet' type='text/css'>
    <link rel="icon" type="image/x-icon" href="/img/favicon.ico?v=5"/>
    <meta name="viewport" content="width=device-width">
    
  <link rel="stylesheet" type="text/css" href="/css/page.css" />
  
  <meta property="og:description" content="Give a nice welcome back to my web server. It has been a month since I found my web server at my apartment to be receiving anomalous traffic on port 80. I had noticed my network being slow, much in the way that cheetahs aren&#39;t. I had an to idea to shut off my webserver and all of a sudden, my network speed jumped back up to normal (well, as normal as crappy Comcast is). To find out what was going on, I did a bunch of TCP dumps and opened it up in Wireshark to see what was going on. Holy crap, thousands of packets in a span of a few seconds, coming from around the world in places like Singapore, Michigan, and the UK. I let it tcpdump, again and again. Once, I let it run for an hour and my webserver had used .5gB of bandwidth just getting pounded by empty packets. Can you say half a million packets...from a single source? I was in a frenzy trying to drop these IPs from my iptables, but like crazed ants, more and more just kept on coming. Even weirder, my webserver was responding and sending a lot of packets to Google. Was I some sort of high-profile target for a DDoS attack? Am I the future leader of humanity against the machine race and terminator web servers were sent back in time to try to kill my box? I installed fail2ban for apache, but it wasn&#39;t doing the job (perhaps I didn&#39;t configure it enough). I was going to try to do a MAC address clone on my router so that Comcast would lease me a new dynamic IP, but I grew weary and had little time. I laid my webserver to sleep and left it under the kitchen table. And this weekend, I took my webserver home back to Portland! It was about time the Internet felt my presence. I reinstalled Debian on my webserver (in case it was somehow rooted), revamped the website from Django to Wok (borrowing elements from when I had worked on the LUG website), and put it back up. I will probably begin hosting my webserver at my home in Portland since the internet here is quite a bit faster, and the internet in my apartment is slow, like slow-like-56k slow. I&#39;ll start to write more blog posts and transfer the blog posts I currently write for the LUG here. To mitigate future compromises, I put my webserver behind two firewalls (although it probably won&#39;t help since port 80 is open), closed off services such as gnump3d and mediatomb, removed the ability to download documents over HTTP, and made access to the webserver via public key only (don&#39;t allow password authentication). It helps that this site is static and therefore can&#39;t be injected with anything. ngokevin.com is back!"/>

  </head>

  <body>
    <div id="wrap" class="c">
      <header>
        <div class="logos">
          <h1 id="logo">
            <a href='/'>ngo<strong>kevin</strong></a>
            <span class="social">
              <a href="mailto:me@ngokevin.com"><i class="fa fa-envelope"></i></a>
              <a href="http://twitter.com/andgokevin"><i class="fa fa-twitter-square"></i></a>
              <a href="http://github.com/ngokevin"><i class="fa fa-github-square"></i></a>
              <a type="application/rss+xml" href="/rss"><i class="fa fa-rss-square"></i></a>
            </span>
          </h1>
          <span id="sublogo">virtual reality developer at mozilla</span>
          <ul class="blog-tags">
            
              <li>
                <a href="/blog/tags/code/"
                   >
                  Code</a>
              </li>
            
              <li>
                <a href="/blog/tags/life/"
                   >
                  Life</a>
              </li>
            
              <li>
                <a href="/blog/tags/photography/"
                   >
                  Shoot</a>
              </li>
            
              <li>
                <a href="/blog/tags/poker/"
                   >
                  Poker</a>
              </li>
            
          </ul>
        </div>

        <nav>
          
            <a href="/about/">
              <span>
                About</span>
            </a>
          
            <a href="/">
              <span>
                Write</span>
            </a>
          
            <a href="/photography/">
              <span>
                Shoot</span>
            </a>
          
        </nav>
      </header>

      <div class="main">
        <div class="header-group">
  <div class="blog">
    <h1>Fending Off a Home Server DDoS</h1>

    <p class="metadata">
      
        Saturday November 05, 2011
      
    </p>
  </div>

  <div id="top-share" class="addthis_toolbox addthis_default_style">
  <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
  <a class="addthis_button_tweet"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-513af3cd5e69b4ae"></script>
</div>

        <div class="base-image">
          
        </div>

        
  <div class="page c">
    <p>Give a nice welcome back to my web server. It has been a month since I found my
web server at my apartment to be receiving <strong>anomalous traffic</strong> on port 80. I
had noticed my network being slow, much in the way that cheetahs aren't. I had
an to idea to shut off my webserver and all of a sudden, my network speed
jumped back up to normal (well, as normal as crappy Comcast is). To find out
what was going on, I did a bunch of <strong>TCP dumps</strong> and opened it up in
<a href="http://wireshark.org">Wireshark</a> to see what was going on.</p>
<p>Holy crap, <strong>thousands of packets</strong> in a span of a few seconds, coming from around
the world in places like Singapore, Michigan, and the UK. I let it tcpdump,
again and again. Once, I let it run for an hour and my webserver had used .5gB
of bandwidth just getting pounded by empty packets. Can you say <em>half a million
packets</em>...from a single source? I was in a frenzy trying to drop these IPs
from my iptables, but like crazed ants, more and more just kept on coming. Even
weirder, my webserver was responding and sending a lot of packets to Google.</p>
<p>Was I some sort of high-profile target for a <em>DDoS</em> attack? Am I the future
leader of humanity against the machine race and terminator web servers were
sent back in time to try to kill my box?</p>
<p>I installed <a href="http://fail2ban.org">fail2ban</a> for apache, but it wasn't doing the job (perhaps I
didn't configure it enough). I was going to try to do a MAC address clone on my
router so that Comcast would lease me a new dynamic IP, but I grew weary and
had little time.  I laid my webserver to sleep and left it under the kitchen
table.</p>
<p>And this weekend, I took my webserver home back to Portland! It was about time
the Internet felt my presence. I reinstalled Debian on my webserver (in case it
was somehow <strong>rooted</strong>), revamped the website from Django to Wok (borrowing
elements from when I had worked on the <a href="http://lug.oregonstate.edu">LUG website</a>), and put it back up.</p>
<p>I will probably begin hosting my webserver at my home in Portland since the
internet here is quite a bit faster, and the internet in my apartment is slow,
like slow-like-56k slow. I'll start to write more blog posts and transfer the
blog posts I currently write for the LUG here.</p>
<p>To <strong>mitigate future compromises</strong>, I put my webserver behind two firewalls
(although it probably won't help since port 80 is open), closed off services
such as gnump3d and mediatomb, removed the ability to download documents over
HTTP, and made access to the webserver via public key only (don't allow
password authentication). It helps that this site is static and therefore can't
be injected with anything.</p>
<p>ngokevin.com is back!</p>
  </div>

  <p class="end-sect">&sect;</p>
  <div id="bottom-share" class="addthis_toolbox addthis_default_style">
  <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
  <a class="addthis_button_tweet"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-513af3cd5e69b4ae"></script>
   <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'ngokevin'; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
           var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
           dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
           (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
  <script src="https://cdn.jsdelivr.net/anchorjs/3.0.0/anchor.min.js"></script>
  <script>anchors.add('h2, h3, h4, h5, h6');</script>

      </div>
    </div>

    <div id="footer">
      <a href="mailto:me@ngokevin.com"><i class="fa fa-envelope"></i></a>
      <a href="http://twitter.com/ngokevin_"><i class="fa fa-twitter-square"></i></a>
      <a href="http://github.com/ngokevin"><i class="fa fa-github-square"></i></a>
      <a type="application/rss+xml" href="/rss/index.xml"><i class="fa fa-rss-square"></i></a>
    </div>

     <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-29871909-1']);
  _gaq.push(['_trackPageview']);

  (function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
  </body>
</html>